# MovieRating

### Описание 

Мы создали проект, который представляет собой систему рекомендаций фильмов, которая основана на анализе предпочтений пользователя и на обработке отзывов с использованием машинного обучения.  
Проект включает:
*	Веб-интерфейс
*	Систему сбора и обработки данных о фильмах
*	Две модели анализа тональности отзывов
*	Алгоритм персонализированных рекомендаций


### Ключевые особенности пректа
*	Подбор фильмов по 5 критериям (юмор, сюжет, кинематографичность, актерская игра, звуковой дизайн)
*	Фильтрация (жанр, тип контента, возрастное ограничение)
*	API Кинопоиска для сбора данных
*	Обученные NLP-модели для анализа отзывов


### Технологический стек
__Основные компоненты:__
*	Backend: Python 3.8, Flask 2.0.2
*	Frontend: HTML5, CSS3, JavaScript
*	База данных: SQLite 3
*	ML-библиотеки: Transformers 4.12.5, PyTorch 1.9.0


__Зависимости:__

Для просмотра всех зависимостей и библиотек перейдите в файл ```requirements.txt```.
### Установка и запуск
__Требования к системе:__
*	ОС: Windows 10/11, macOS 12+
*	Память: 4 ГБ ОЗУ (8 ГБ)
*	Диск: 8 ГБ свободного места
  
__Инструкция по установке__
1.	Клонировать репозиторий:
``` bash 
git clone https://github.com/lianapestereva/MovieRating
```
2.	Установить зависимости:
``` bash
pip install -r requirements.txt
```
3. Тренировка модели:
   
   Из терминала запустить файлы: ```train_absa_model.py```, ```train_detection_model.py ```

   После тренировки модели поменять в переменной absa_model checkpoint на один из checkpoint'ов, что высветится в папке ```absa_model```, поменять в переменной detect_model checkpoint на один из checkpoint'ов, что высветится в папке ```detect_model``` 

```
   absa_model = AutoModelForSequenceClassification.from_pretrained(
    r"X")
detect_model = AutoModelForTokenClassification.from_pretrained(
    r"Y")
```
3.	Запустить приложение:
``` bash
python app.py
```
4.	Открыть в браузере:
``` bash
http://localhost:5000
```

### Структура проекта
__Основные модули:__

```app.py```: 
Главный скрипт Flask-приложения:
*	Маршруты веб-интерфейса
*	Запросы от клиента
*	Формирование рекомендаций
*	Взаимодействие с БД

```absa.py```: 
Модуль анализа тональности отзывов:
*	Функция детекции аспектов (predict_aspects)
*	Функция определения тональности (predict_aspect_sentiment)
*	Основная функция анализа отзыва (analyze_review)

```train_detection_model.p```:
Модель детекции аспектов
* Токенизация текста с сохранением границ слов
* Прогнозирование меток для каждого токена
* Группировка последовательных токенов с одинаковыми метками
* Фильтрация нерелевантных аспектов (класс O)

```train_absa_model.py```:
Модель анализа тональности
* Выбор класса с максимальным значением
* Определение аспекта и тональности по ID класса
* Преобразование в числовой формат (-1, 0, 1)
* Учет контекста вокруг аспекта
* Обработка противоречивых упоминаний
* Нормализация слабых предсказаний

```kinopoisk_scraping.py```: 
Скрипт для сбора данных с API Кинопоиска:
*	Получение информации о фильмах
*	Сбор отзывов
*	Сохранение данных в SQLite

```film_processing.py```: 
Обработка фильмов и анализ отзывов:
* Пакетная обработка всех фильмов в БД
*	Расчет средних оценок по аспектам
*	Сохранение результатов анализа

### Формат данных
Таблица films в БД содержит:
*	ID фильма
*	Название
*	Рейтинг Кинопоиска
*	Является ли сериалом (0/1)
*	Жанры (JSON-строка)
*	Отзывы (JSON-строка)
*	Возрастной рейтинг
*	Продолжительность
*	Год выпуска

### Авторы
*	Пестерева Лиана, Друкман Алиса, Калягина Анна
*	Контактный email (Директор): lspestereva@edu.hse.ru
